---
layout: post
permalink: lc0588 
---

## 588 Design In-Memory File System $

```java
class Dir{
    String dirName;
    Map<String, Dir> dirs;
    Map<String, File> files;
    public Dir(String name){
        this.dirName= name;
        dirs = new HashMap();
        files = new HashMap();
    }
}

class File{
    String fileName;
    String content;
    public File(String name, String content){
        this.fileName= name;
        this.content = content;
    }
}

class FileSystem {

    Dir root = null;
    
    public FileSystem() {
        root = new Dir("root");
    }
    
    public List<String> ls(String path) {        
        Dir tracePath = root;
        String[] p = path.split("/");
        
        List<String> result = new ArrayList();
        
        if(p.length==0){
            for(String dir : tracePath.dirs.keySet()) result.add(dir);
            for(String file : tracePath.files.keySet()) result.add(file); 
        }
        else{
            for(int i = 0; i < p.length; i++){
                if(p[i].length()>0){
                    if(i != p.length-1 && tracePath.dirs.containsKey(p[i]))
                       tracePath =  tracePath.dirs.get(p[i]);
                    else if(i == p.length-1 && tracePath.dirs.containsKey(p[i])){
                        tracePath =  tracePath.dirs.get(p[i]);
                        for(String dir : tracePath.dirs.keySet()) result.add(dir);
                        for(String file : tracePath.files.keySet()) result.add(file);                      
                    }
                    else{
                        if(i == p.length-1 && tracePath.files.containsKey(p[i])){
                            result.add(p[i]);
                        }
                    }
                }
            }
        }
        Collections.sort(result);
        return result;
    }
    
    public void mkdir(String path) {
        String[] p = path.split("/");
        Dir tracePath = root;
        for(int i = 0; i < p.length; i++){
            if(p[i].length()>0){
                if(tracePath.dirs.containsKey(p[i])) tracePath = tracePath.dirs.get(p[i]);
                else{
                    Dir d = new Dir(p[i]);
                    tracePath.dirs.put(p[i], d);
                    tracePath = d;
                }
            }
        }
    }
    
    public void addContentToFile(String filePath, String content) {
        String[] p = filePath.split("/");
        Dir tracePath = root;
        for(int i = 0; i < p.length-1; i++){
            if(p[i].length()>0){
                if(tracePath.dirs.containsKey(p[i])) tracePath = tracePath.dirs.get(p[i]);
                else{
                    Dir d = new Dir(p[i]);
                    tracePath.dirs.put(p[i], d);
                    tracePath = d;
                }
            }
        }
        if(tracePath.files.containsKey(p[p.length-1])) tracePath.files.get(p[p.length-1]).content += content;
        else{
            tracePath.files.put(p[p.length-1], new File(p[p.length-1], content));
        }
        
    }
    
    public String readContentFromFile(String filePath) {
        String[] p = filePath.split("/");
        Dir tracePath = root;
        for(int i = 0; i < p.length-1; i++){
            if(p[i].length()>0){
                if(tracePath.dirs.containsKey(p[i])) tracePath = tracePath.dirs.get(p[i]);
                else {
                    tracePath = null; break;
                }
            }
        }
        
        if(tracePath!=null && tracePath.files.containsKey(p[p.length-1])) return tracePath.files.get(p[p.length-1]).content;
        return "";
    }
}

/**
 * Your FileSystem object will be instantiated and called as such:
 * FileSystem obj = new FileSystem();
 * List<String> param_1 = obj.ls(path);
 * obj.mkdir(path);
 * obj.addContentToFile(filePath,content);
 * String param_4 = obj.readContentFromFile(filePath);
 */
```

